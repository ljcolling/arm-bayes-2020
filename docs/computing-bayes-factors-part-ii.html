<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Computing Bayes factors Part II | Bayesian Data Analysis</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Computing Bayes factors Part II | Bayesian Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Computing Bayes factors Part II | Bayesian Data Analysis" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Lincoln Colling" />


<meta name="date" content="2020-04-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="computing-bayes-factors-part-i.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="the-p-value.html"><a href="the-p-value.html"><i class="fa fa-check"></i><b>1</b> The <em>p</em> value</a><ul>
<li class="chapter" data-level="1.1" data-path="the-p-value.html"><a href="the-p-value.html#probability"><i class="fa fa-check"></i><b>1.1</b> Probability</a></li>
<li class="chapter" data-level="1.2" data-path="the-p-value.html"><a href="the-p-value.html#probability-and-p-values"><i class="fa fa-check"></i><b>1.2</b> Probability and <em>p</em> values</a><ul>
<li class="chapter" data-level="1.2.1" data-path="the-p-value.html"><a href="the-p-value.html#understanding-the-p-through-simulation"><i class="fa fa-check"></i><b>1.2.1</b> Understanding the <em>p</em> through simulation</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="the-p-value.html"><a href="the-p-value.html#interim-summary"><i class="fa fa-check"></i><b>1.3</b> Interim summary</a></li>
<li class="chapter" data-level="1.4" data-path="the-p-value.html"><a href="the-p-value.html#a-short-note-on-confidence-intervals"><i class="fa fa-check"></i><b>1.4</b> A short note on confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="criticisms-of-p-values.html"><a href="criticisms-of-p-values.html"><i class="fa fa-check"></i><b>2</b> Criticisms of <em>p</em> values</a><ul>
<li class="chapter" data-level="2.1" data-path="criticisms-of-p-values.html"><a href="criticisms-of-p-values.html#same-measurements-from-different-devices"><i class="fa fa-check"></i><b>2.1</b> Same measurements from different devices</a></li>
<li class="chapter" data-level="2.2" data-path="criticisms-of-p-values.html"><a href="criticisms-of-p-values.html#the-universe-of-possible-events"><i class="fa fa-check"></i><b>2.2</b> The universe of possible events</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-evidential-alternative-to-p-values.html"><a href="the-evidential-alternative-to-p-values.html"><i class="fa fa-check"></i><b>3</b> The evidential alternative to <em>p</em> values</a><ul>
<li class="chapter" data-level="3.1" data-path="the-evidential-alternative-to-p-values.html"><a href="the-evidential-alternative-to-p-values.html#a-theory-of-statistical-evidence"><i class="fa fa-check"></i><b>3.1</b> A theory of statistical evidence</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-evidential-alternative-to-p-values.html"><a href="the-evidential-alternative-to-p-values.html#some-features-of-likelihoods"><i class="fa fa-check"></i><b>3.1.1</b> Some features of likelihoods</a></li>
<li class="chapter" data-level="3.1.2" data-path="the-evidential-alternative-to-p-values.html"><a href="the-evidential-alternative-to-p-values.html#likelihoods-and-statistical-evidence"><i class="fa fa-check"></i><b>3.1.2</b> Likelihoods and statistical evidence</a></li>
<li class="chapter" data-level="3.1.3" data-path="the-evidential-alternative-to-p-values.html"><a href="the-evidential-alternative-to-p-values.html#are-all-sub-hypotheses-equal"><i class="fa fa-check"></i><b>3.1.3</b> Are all sub-hypotheses equal?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>4</b> Bayes rule</a><ul>
<li class="chapter" data-level="4.1" data-path="bayes-rule.html"><a href="bayes-rule.html#what-is-bayes-rule"><i class="fa fa-check"></i><b>4.1</b> What is Bayes rule</a><ul>
<li class="chapter" data-level="4.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#conditional-probability-form"><i class="fa fa-check"></i><b>4.1.1</b> Conditional probability form</a></li>
<li class="chapter" data-level="4.1.2" data-path="bayes-rule.html"><a href="bayes-rule.html#proportional-form"><i class="fa fa-check"></i><b>4.1.2</b> Proportional form</a></li>
<li class="chapter" data-level="4.1.3" data-path="bayes-rule.html"><a href="bayes-rule.html#ratio-form"><i class="fa fa-check"></i><b>4.1.3</b> Ratio form</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-factor"><i class="fa fa-check"></i><b>4.2</b> Bayes factor</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="choosing-priors-part-i.html"><a href="choosing-priors-part-i.html"><i class="fa fa-check"></i><b>5</b> Choosing priors Part I</a><ul>
<li class="chapter" data-level="5.1" data-path="choosing-priors-part-i.html"><a href="choosing-priors-part-i.html#priors-with-specific-mathematical-properties"><i class="fa fa-check"></i><b>5.1</b> Priors with specific mathematical properties</a></li>
<li class="chapter" data-level="5.2" data-path="choosing-priors-part-i.html"><a href="choosing-priors-part-i.html#priors-that-reflect-ignorance"><i class="fa fa-check"></i><b>5.2</b> Priors that reflect ignorance</a></li>
<li class="chapter" data-level="5.3" data-path="choosing-priors-part-i.html"><a href="choosing-priors-part-i.html#priors-that-reflect-our-beliefs-about-the-world."><i class="fa fa-check"></i><b>5.3</b> Priors that reflect our beliefs about the world.</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="computing-bayes-factors-part-i.html"><a href="computing-bayes-factors-part-i.html"><i class="fa fa-check"></i><b>6</b> Computing Bayes factors Part I</a><ul>
<li class="chapter" data-level="6.1" data-path="computing-bayes-factors-part-i.html"><a href="computing-bayes-factors-part-i.html#priors-on-effect-sizes"><i class="fa fa-check"></i><b>6.1</b> Priors on effect sizes</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="computing-bayes-factors-part-ii.html"><a href="computing-bayes-factors-part-ii.html"><i class="fa fa-check"></i><b>7</b> Computing Bayes factors Part II</a><ul>
<li class="chapter" data-level="7.1" data-path="computing-bayes-factors-part-ii.html"><a href="computing-bayes-factors-part-ii.html#priors-on-raw-effects"><i class="fa fa-check"></i><b>7.1</b> Priors on raw effects</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/ljcolling/notebooks" target="blank">View on GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="computing-bayes-factors-part-ii" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Computing Bayes factors Part II</h1>
<div id="priors-on-raw-effects" class="section level2">
<h2><span class="header-section-number">7.1</span> Priors on raw effects</h2>
<p>To explore this, we’re going to look at a few examples from <a href="https://www.frontiersin.org/articles/10.3389/fpsyg.2014.00781">Dienes (2014)</a>.</p>
<p>Dienes (2014) presents an example of Dienes et al (2012) where it was predicted that negative mood would <strong>reduce</strong> a certain type of learning. Participants performed a two-alternative forced choice task where chance was 50%. Learning was measured in a neutral condition and a negative mood condition. It was found that in the neutral condition accuracy was 70%. Therefore, the theory that negative mood <strong>reduces learning</strong> would predict that in the negative mood condition accuracy would be somewhere between 50% (i.e., chance) and 70%.
It happened to be the case that in the negative mood condition accuracy was 65%. How can one analyse these data?</p>
<p>One option is to do a <em>t</em>-test. It so happened that a <em>t</em>-test produced the following result: <em>t</em>(50) = 0.5, <em>p</em> = .62. Another option would be a <strong>Bayes factor analysis</strong>. To do this we’ll need 4 things:</p>
<ol style="list-style-type: decimal">
<li>A parameter to make inferences about</li>
<li>A likelihood function relating our data to likely values of the parameter</li>
<li>A model of <span class="math inline">\(\mathcal{H}_0\)</span></li>
<li>A model of <span class="math inline">\(\mathcal{H}_1\)</span></li>
</ol>
<p>For this example, we’ll make inferences about the <strong>mean difference in accuracy</strong>. For our likelihood function, we’ll choose either a <strong>normal distribution</strong> or a <strong>scaled and shifted <em>t</em> distribution</strong>. For our <span class="math inline">\(\mathcal{H}_0\)</span>, we’ll keep it simple and choose a point null—that is, mean difference = 0. For our <span class="math inline">\(\mathcal{H}_1\)</span>, however, we’re actually going to try represent the predictions of the theory.</p>
<p>So to recap, the theory predicts that in the negative condition, accuracy will be somewhere between 50-70% (i.e., more than chance but less than in the neutral condition). In terms of the mean difference between conditions, this means that the theory predicts a mean difference between 0% and 20%. We’ll follow Dienes (2014) and represent this prediction with the <strong>Uniform</strong> prior between 0% and 20% (however, you might want to think about other ways to represent this).</p>
<p>So let’s put the parts together.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="computing-bayes-factors-part-ii.html#cb87-1"></a><span class="co"># 1</span></span>
<span id="cb87-2"><a href="computing-bayes-factors-part-ii.html#cb87-2"></a></span>
<span id="cb87-3"><a href="computing-bayes-factors-part-ii.html#cb87-3"></a></span>
<span id="cb87-4"><a href="computing-bayes-factors-part-ii.html#cb87-4"></a><span class="co"># to define the likelihood we&#39;ll need the mean and the standard error</span></span>
<span id="cb87-5"><a href="computing-bayes-factors-part-ii.html#cb87-5"></a></span>
<span id="cb87-6"><a href="computing-bayes-factors-part-ii.html#cb87-6"></a>negative_mood_acc =<span class="st"> </span><span class="dv">65</span></span>
<span id="cb87-7"><a href="computing-bayes-factors-part-ii.html#cb87-7"></a>neutral_acc =<span class="st"> </span><span class="dv">70</span></span>
<span id="cb87-8"><a href="computing-bayes-factors-part-ii.html#cb87-8"></a>mean_diff =<span class="st"> </span><span class="kw">abs</span>(negative_mood_acc <span class="op">-</span><span class="st"> </span>neutral_acc)</span>
<span id="cb87-9"><a href="computing-bayes-factors-part-ii.html#cb87-9"></a>t_stat =<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb87-10"><a href="computing-bayes-factors-part-ii.html#cb87-10"></a>se =<span class="st"> </span>mean_diff <span class="op">/</span><span class="st"> </span>t_stat</span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="computing-bayes-factors-part-ii.html#cb88-1"></a><span class="co"># 2</span></span>
<span id="cb88-2"><a href="computing-bayes-factors-part-ii.html#cb88-2"></a></span>
<span id="cb88-3"><a href="computing-bayes-factors-part-ii.html#cb88-3"></a></span>
<span id="cb88-4"><a href="computing-bayes-factors-part-ii.html#cb88-4"></a><span class="co"># define the likelihood</span></span>
<span id="cb88-5"><a href="computing-bayes-factors-part-ii.html#cb88-5"></a><span class="co"># we&#39;ll use a normal likelihood</span></span>
<span id="cb88-6"><a href="computing-bayes-factors-part-ii.html#cb88-6"></a><span class="co"># another option could be to use the scaled shifted t distribution</span></span>
<span id="cb88-7"><a href="computing-bayes-factors-part-ii.html#cb88-7"></a><span class="co"># but we&#39;ll use it because Dienes (2014) uses a normal</span></span>
<span id="cb88-8"><a href="computing-bayes-factors-part-ii.html#cb88-8"></a></span>
<span id="cb88-9"><a href="computing-bayes-factors-part-ii.html#cb88-9"></a></span>
<span id="cb88-10"><a href="computing-bayes-factors-part-ii.html#cb88-10"></a>data_model1 =<span class="st"> </span><span class="kw">norm.lik</span>(<span class="dt">center =</span> mean_diff, <span class="dt">scale =</span>  se)</span>
<span id="cb88-11"><a href="computing-bayes-factors-part-ii.html#cb88-11"></a>data_model2 =<span class="st"> </span><span class="kw">scaled.shifted.t.lik</span>(<span class="dt">center =</span> mean_diff, <span class="dt">scale =</span>  se, <span class="dt">df =</span> <span class="dv">50</span>)</span>
<span id="cb88-12"><a href="computing-bayes-factors-part-ii.html#cb88-12"></a></span>
<span id="cb88-13"><a href="computing-bayes-factors-part-ii.html#cb88-13"></a></span>
<span id="cb88-14"><a href="computing-bayes-factors-part-ii.html#cb88-14"></a>norm =<span class="st"> </span><span class="kw">plot</span>(data_model1, <span class="dt">theta =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">40</span>,<span class="dv">40</span>,.<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> mean_diff, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb88-15"><a href="computing-bayes-factors-part-ii.html#cb88-15"></a><span class="kw">scale_x_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;mean difference&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">40</span>,<span class="dv">40</span>,<span class="dv">20</span>),mean_diff)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>(<span class="dv">12</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb88-16"><a href="computing-bayes-factors-part-ii.html#cb88-16"></a><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;normal&quot;</span>)</span>
<span id="cb88-17"><a href="computing-bayes-factors-part-ii.html#cb88-17"></a>scaled_t =<span class="st"> </span><span class="kw">plot</span>(data_model2, <span class="dt">theta =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">40</span>,<span class="dv">40</span>,.<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> mean_diff, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb88-18"><a href="computing-bayes-factors-part-ii.html#cb88-18"></a><span class="kw">scale_x_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;mean difference&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">40</span>,<span class="dv">40</span>,<span class="dv">20</span>),mean_diff)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>(<span class="dv">12</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb88-19"><a href="computing-bayes-factors-part-ii.html#cb88-19"></a><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;shifted scaled t&quot;</span>)</span>
<span id="cb88-20"><a href="computing-bayes-factors-part-ii.html#cb88-20"></a></span>
<span id="cb88-21"><a href="computing-bayes-factors-part-ii.html#cb88-21"></a>norm <span class="op">/</span><span class="st"> </span>scaled_t <span class="op">+</span><span class="st"> </span><span class="kw">plot_annotation</span>(<span class="dt">tag_levels =</span> <span class="st">&quot;A&quot;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="computing-bayes-factors-part-ii.html#cb89-1"></a>data_model =<span class="st"> </span>data_model1</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="computing-bayes-factors-part-ii.html#cb90-1"></a><span class="co"># 3</span></span>
<span id="cb90-2"><a href="computing-bayes-factors-part-ii.html#cb90-2"></a></span>
<span id="cb90-3"><a href="computing-bayes-factors-part-ii.html#cb90-3"></a><span class="co"># define model / priors</span></span>
<span id="cb90-4"><a href="computing-bayes-factors-part-ii.html#cb90-4"></a></span>
<span id="cb90-5"><a href="computing-bayes-factors-part-ii.html#cb90-5"></a>h0_model =<span class="st"> </span><span class="cf">function</span>(theta.range){</span>
<span id="cb90-6"><a href="computing-bayes-factors-part-ii.html#cb90-6"></a>    <span class="kw">list</span>(<span class="dt">func =</span> <span class="cf">function</span>(theta) <span class="kw">ifelse</span>(theta <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="co"># a point null with mean diff = 0</span></span>
<span id="cb90-7"><a href="computing-bayes-factors-part-ii.html#cb90-7"></a>         <span class="dt">theta.range =</span> theta.range)</span>
<span id="cb90-8"><a href="computing-bayes-factors-part-ii.html#cb90-8"></a>}</span>
<span id="cb90-9"><a href="computing-bayes-factors-part-ii.html#cb90-9"></a></span>
<span id="cb90-10"><a href="computing-bayes-factors-part-ii.html#cb90-10"></a>h1_model =<span class="st"> </span><span class="cf">function</span>(theta.range){</span>
<span id="cb90-11"><a href="computing-bayes-factors-part-ii.html#cb90-11"></a>    <span class="kw">list</span>(<span class="dt">func =</span> <span class="cf">function</span>(theta) <span class="kw">dunif</span>(<span class="dt">x =</span> theta, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">20</span>), <span class="co"># uniform prior from 0 to 20</span></span>
<span id="cb90-12"><a href="computing-bayes-factors-part-ii.html#cb90-12"></a>         <span class="dt">theta.range =</span> theta.range)</span>
<span id="cb90-13"><a href="computing-bayes-factors-part-ii.html#cb90-13"></a>}</span>
<span id="cb90-14"><a href="computing-bayes-factors-part-ii.html#cb90-14"></a></span>
<span id="cb90-15"><a href="computing-bayes-factors-part-ii.html#cb90-15"></a><span class="co"># plot the h1 prior </span></span>
<span id="cb90-16"><a href="computing-bayes-factors-part-ii.html#cb90-16"></a></span>
<span id="cb90-17"><a href="computing-bayes-factors-part-ii.html#cb90-17"></a>theta.range =<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">30</span>,.<span class="dv">1</span>) <span class="co"># from -10 to +30 in steps 0.1</span></span>
<span id="cb90-18"><a href="computing-bayes-factors-part-ii.html#cb90-18"></a></span>
<span id="cb90-19"><a href="computing-bayes-factors-part-ii.html#cb90-19"></a><span class="co"># then make a tibble with the data for the plot</span></span>
<span id="cb90-20"><a href="computing-bayes-factors-part-ii.html#cb90-20"></a><span class="kw">tibble</span>(<span class="dt">theta =</span> theta.range, <span class="dt">p =</span> <span class="kw">h1_model</span>(theta.range)<span class="op">$</span><span class="kw">func</span>(theta.range)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb90-21"><a href="computing-bayes-factors-part-ii.html#cb90-21"></a><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">y =</span> p)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;mean difference&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb90-22"><a href="computing-bayes-factors-part-ii.html#cb90-22"></a><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;p(mean difference)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>(<span class="dv">12</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="computing-bayes-factors-part-ii.html#cb91-1"></a><span class="co"># 4</span></span>
<span id="cb91-2"><a href="computing-bayes-factors-part-ii.html#cb91-2"></a></span>
<span id="cb91-3"><a href="computing-bayes-factors-part-ii.html#cb91-3"></a><span class="co"># multiply the prior and likelihoods and priors</span></span>
<span id="cb91-4"><a href="computing-bayes-factors-part-ii.html#cb91-4"></a>M0 =<span class="st"> </span>data_model <span class="op">*</span><span class="st"> </span><span class="kw">h0_model</span>(<span class="dt">theta.range =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb91-5"><a href="computing-bayes-factors-part-ii.html#cb91-5"></a></span>
<span id="cb91-6"><a href="computing-bayes-factors-part-ii.html#cb91-6"></a>M1 =<span class="st"> </span>data_model <span class="op">*</span><span class="st"> </span><span class="kw">h1_model</span>(<span class="dt">theta.range =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="ot">Inf</span>))</span>
<span id="cb91-7"><a href="computing-bayes-factors-part-ii.html#cb91-7"></a></span>
<span id="cb91-8"><a href="computing-bayes-factors-part-ii.html#cb91-8"></a></span>
<span id="cb91-9"><a href="computing-bayes-factors-part-ii.html#cb91-9"></a>BF10 =<span class="st"> </span>M1<span class="op">$</span>integral <span class="op">/</span><span class="st"> </span>M0<span class="op">$</span>integral</span>
<span id="cb91-10"><a href="computing-bayes-factors-part-ii.html#cb91-10"></a>glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&quot;B&lt;sub&gt;10&lt;/sub&gt; = {round(BF10,2)}&quot;</span>)</span></code></pre></div>
<p>B<sub>10</sub> = 0.89</p>
<p>Now that we have our BF as a number, we’ll convert that into a verbal label using the categories for <a href="https://doi.org/10.3758/s13423-017-1323-7">Wagenmakers et al (2017)</a>.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="computing-bayes-factors-part-ii.html#cb92-1"></a><span class="co">#5 </span></span>
<span id="cb92-2"><a href="computing-bayes-factors-part-ii.html#cb92-2"></a></span>
<span id="cb92-3"><a href="computing-bayes-factors-part-ii.html#cb92-3"></a><span class="kw">bfsay</span>(BF10, <span class="dt">numerator =</span> <span class="st">&quot;M1&quot;</span>, <span class="dt">denominator =</span> <span class="st">&quot;M0&quot;</span>)</span></code></pre></div>
<p>Using the levels from Wagenmakers et al (2017; <a href="https://doi.org/10.3758/s13423-017-1323-7" class="uri">https://doi.org/10.3758/s13423-017-1323-7</a>)
A BF of 0.887225881943733 indicates:
Anecdotal evidence for M0</p>
<p>So we can see that once we take into account the predictions of the theory, our difference between conditions doesn’t really discriminate between <span class="math inline">\(\mathcal{H}_0\)</span> and <span class="math inline">\(\mathcal{H}_1\)</span>. We did find <strong>some</strong> evidence in favour of <span class="math inline">\(\mathcal{H}_0\)</span>, but it wasn’t very much at all.</p>
<p>Dienes extends the example a bit to show how <strong>BFs</strong> and <em>p</em>-values will sometimes lead to different conclusions. It’s worth examining the example to understand why this is the case. It’ll help us understand both <strong>BFs</strong> and <em>p</em>-values better.</p>
<p>Dienes asks to consider two examples:</p>
<ol style="list-style-type: decimal">
<li>A mean difference of 1 with a standard error of 10</li>
<li>A mean difference of 1 with a standard error of 1</li>
</ol>
<p>He goes on to calculate <em>p</em> values and <strong>BFs</strong> (using the above model<sup>1</sup>) for both examples. We’ll do the same, and examine the results.</p>
<p><sup>1</sup><small>A key point here is that the exact same priors are used for both examples. We might want to question whether this is reasonable.</small></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="computing-bayes-factors-part-ii.html#cb93-1"></a><span class="co"># 6</span></span>
<span id="cb93-2"><a href="computing-bayes-factors-part-ii.html#cb93-2"></a></span>
<span id="cb93-3"><a href="computing-bayes-factors-part-ii.html#cb93-3"></a><span class="co"># Example 1 (t test)</span></span>
<span id="cb93-4"><a href="computing-bayes-factors-part-ii.html#cb93-4"></a></span>
<span id="cb93-5"><a href="computing-bayes-factors-part-ii.html#cb93-5"></a>mean_diff =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb93-6"><a href="computing-bayes-factors-part-ii.html#cb93-6"></a>se<span class="fl">.1</span> =<span class="st"> </span><span class="dv">10</span></span>
<span id="cb93-7"><a href="computing-bayes-factors-part-ii.html#cb93-7"></a>df =<span class="st"> </span><span class="dv">50</span></span>
<span id="cb93-8"><a href="computing-bayes-factors-part-ii.html#cb93-8"></a>t_stat<span class="fl">.1</span> =<span class="st"> </span>mean_diff <span class="op">/</span><span class="st"> </span>se<span class="fl">.1</span></span>
<span id="cb93-9"><a href="computing-bayes-factors-part-ii.html#cb93-9"></a>p_value<span class="fl">.1</span> =<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">pt</span>(t_stat<span class="fl">.1</span>, df,<span class="dt">lower.tail =</span> F)</span>
<span id="cb93-10"><a href="computing-bayes-factors-part-ii.html#cb93-10"></a></span>
<span id="cb93-11"><a href="computing-bayes-factors-part-ii.html#cb93-11"></a>glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&quot;For Example 1, a standard *t* test gives the result: *t*({df}) = {round(t_stat.1,2)}, </span></span>
<span id="cb93-12"><a href="computing-bayes-factors-part-ii.html#cb93-12"></a><span class="st">*p* = {round(p_value.1,2)}&quot;</span>) </span></code></pre></div>
<p>For Example 1, a standard <em>t</em> test gives the result: <em>t</em>(50) = 0.1,
<em>p</em> = 0.92</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="computing-bayes-factors-part-ii.html#cb94-1"></a><span class="co"># 7</span></span>
<span id="cb94-2"><a href="computing-bayes-factors-part-ii.html#cb94-2"></a></span>
<span id="cb94-3"><a href="computing-bayes-factors-part-ii.html#cb94-3"></a><span class="co"># Example 1 with BFs</span></span>
<span id="cb94-4"><a href="computing-bayes-factors-part-ii.html#cb94-4"></a></span>
<span id="cb94-5"><a href="computing-bayes-factors-part-ii.html#cb94-5"></a><span class="co"># We&#39;ll use the same priors as before so we just have to change the likelihood (aka data mode)</span></span>
<span id="cb94-6"><a href="computing-bayes-factors-part-ii.html#cb94-6"></a></span>
<span id="cb94-7"><a href="computing-bayes-factors-part-ii.html#cb94-7"></a>data_model<span class="fl">.1</span> =<span class="st"> </span><span class="kw">norm.lik</span>(<span class="dt">center =</span> mean_diff, <span class="dt">scale =</span>  se<span class="fl">.1</span>)</span>
<span id="cb94-8"><a href="computing-bayes-factors-part-ii.html#cb94-8"></a></span>
<span id="cb94-9"><a href="computing-bayes-factors-part-ii.html#cb94-9"></a>M0 =<span class="st"> </span>data_model<span class="fl">.1</span> <span class="op">*</span><span class="st"> </span><span class="kw">h0_model</span>(<span class="dt">theta.range =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb94-10"><a href="computing-bayes-factors-part-ii.html#cb94-10"></a></span>
<span id="cb94-11"><a href="computing-bayes-factors-part-ii.html#cb94-11"></a>M1 =<span class="st"> </span>data_model<span class="fl">.1</span> <span class="op">*</span><span class="st"> </span><span class="kw">h1_model</span>(<span class="dt">theta.range =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="ot">Inf</span>))</span>
<span id="cb94-12"><a href="computing-bayes-factors-part-ii.html#cb94-12"></a>BF01<span class="fl">.1</span> =<span class="st"> </span>M0<span class="op">$</span>integral <span class="op">/</span><span class="st"> </span>M1<span class="op">$</span>integral</span>
<span id="cb94-13"><a href="computing-bayes-factors-part-ii.html#cb94-13"></a>glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&quot;For example 1, the BF analysis gives B&lt;sub&gt;01&lt;/sub&gt; = {round(BF01.1,2)}&quot;</span>) </span></code></pre></div>
<p>For example 1, the BF analysis gives B<sub>01</sub> = 1.55</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="computing-bayes-factors-part-ii.html#cb95-1"></a><span class="kw">bfsay</span>(BF01<span class="fl">.1</span>,<span class="st">&quot;M0&quot;</span>,<span class="st">&quot;M1&quot;</span>)</span></code></pre></div>
<p>Using the levels from Wagenmakers et al (2017; <a href="https://doi.org/10.3758/s13423-017-1323-7" class="uri">https://doi.org/10.3758/s13423-017-1323-7</a>)
A BF of 1.55259053332338 indicates:
Anecdotal evidence for M0</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="computing-bayes-factors-part-ii.html#cb96-1"></a><span class="co"># 7</span></span>
<span id="cb96-2"><a href="computing-bayes-factors-part-ii.html#cb96-2"></a></span>
<span id="cb96-3"><a href="computing-bayes-factors-part-ii.html#cb96-3"></a><span class="co"># Example 2 (t test)</span></span>
<span id="cb96-4"><a href="computing-bayes-factors-part-ii.html#cb96-4"></a></span>
<span id="cb96-5"><a href="computing-bayes-factors-part-ii.html#cb96-5"></a>mean_diff =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb96-6"><a href="computing-bayes-factors-part-ii.html#cb96-6"></a>se<span class="fl">.2</span> =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb96-7"><a href="computing-bayes-factors-part-ii.html#cb96-7"></a>df =<span class="st"> </span><span class="dv">50</span></span>
<span id="cb96-8"><a href="computing-bayes-factors-part-ii.html#cb96-8"></a>t_stat<span class="fl">.2</span> =<span class="st"> </span>mean_diff <span class="op">/</span><span class="st"> </span>se<span class="fl">.2</span></span>
<span id="cb96-9"><a href="computing-bayes-factors-part-ii.html#cb96-9"></a>p_value<span class="fl">.2</span> =<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">pt</span>(t_stat<span class="fl">.2</span>, df,<span class="dt">lower.tail =</span> F)</span>
<span id="cb96-10"><a href="computing-bayes-factors-part-ii.html#cb96-10"></a></span>
<span id="cb96-11"><a href="computing-bayes-factors-part-ii.html#cb96-11"></a>glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&quot;For Example 2, a standard *t* test gives the result: *t*({df}) = {round(t_stat.2,2)}, </span></span>
<span id="cb96-12"><a href="computing-bayes-factors-part-ii.html#cb96-12"></a><span class="st">*p* = {round(p_value.2,2)}&quot;</span>) </span></code></pre></div>
<p>For Example 2, a standard <em>t</em> test gives the result: <em>t</em>(50) = 1,
<em>p</em> = 0.32</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="computing-bayes-factors-part-ii.html#cb97-1"></a><span class="co"># 8</span></span>
<span id="cb97-2"><a href="computing-bayes-factors-part-ii.html#cb97-2"></a></span>
<span id="cb97-3"><a href="computing-bayes-factors-part-ii.html#cb97-3"></a><span class="co"># Example 2 with BFs</span></span>
<span id="cb97-4"><a href="computing-bayes-factors-part-ii.html#cb97-4"></a></span>
<span id="cb97-5"><a href="computing-bayes-factors-part-ii.html#cb97-5"></a><span class="co"># We&#39;ll use the same priors as before so we just have to change the likelihood (aka data mode)</span></span>
<span id="cb97-6"><a href="computing-bayes-factors-part-ii.html#cb97-6"></a></span>
<span id="cb97-7"><a href="computing-bayes-factors-part-ii.html#cb97-7"></a>data_model<span class="fl">.2</span> =<span class="st"> </span><span class="kw">norm.lik</span>(<span class="dt">center =</span> mean_diff, <span class="dt">scale =</span>  se<span class="fl">.2</span>)</span>
<span id="cb97-8"><a href="computing-bayes-factors-part-ii.html#cb97-8"></a></span>
<span id="cb97-9"><a href="computing-bayes-factors-part-ii.html#cb97-9"></a>M0 =<span class="st"> </span>data_model<span class="fl">.2</span> <span class="op">*</span><span class="st"> </span><span class="kw">h0_model</span>(<span class="dt">theta.range =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb97-10"><a href="computing-bayes-factors-part-ii.html#cb97-10"></a></span>
<span id="cb97-11"><a href="computing-bayes-factors-part-ii.html#cb97-11"></a>M1 =<span class="st"> </span>data_model<span class="fl">.2</span> <span class="op">*</span><span class="st"> </span><span class="kw">h1_model</span>(<span class="dt">theta.range =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="ot">Inf</span>))</span>
<span id="cb97-12"><a href="computing-bayes-factors-part-ii.html#cb97-12"></a>BF01<span class="fl">.2</span> =<span class="st"> </span>M0<span class="op">$</span>integral <span class="op">/</span><span class="st"> </span>M1<span class="op">$</span>integral</span>
<span id="cb97-13"><a href="computing-bayes-factors-part-ii.html#cb97-13"></a>glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&quot;For example 2, the BF analysis gives B&lt;sub&gt;01&lt;/sub&gt; = {round(BF01.2,2)}&quot;</span>) </span></code></pre></div>
<p>For example 2, the BF analysis gives B<sub>01</sub> = 5.75</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="computing-bayes-factors-part-ii.html#cb98-1"></a><span class="kw">bfsay</span>(BF01<span class="fl">.2</span>,<span class="st">&quot;M0&quot;</span>,<span class="st">&quot;M1&quot;</span>)</span></code></pre></div>
<p>Using the levels from Wagenmakers et al (2017; <a href="https://doi.org/10.3758/s13423-017-1323-7" class="uri">https://doi.org/10.3758/s13423-017-1323-7</a>)
A BF of 5.75200016141882 indicates:
Moderate evidence for M0</p>
<p>Understanding the difference between these two inferences highlights how the two kinds of analysis ask different questions. Remember, <em>p</em> values ask about whether <strong>data are surprising</strong> given a particular parameter value. In contrast, <strong>BFs</strong> ask about <strong>plausible values of a parameter</strong>. We can highlight this different by plotting, on the same figure, the range of <strong>unsurprising</strong> data values and the <strong>likely values of the parameter</strong> given our data.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="computing-bayes-factors-part-ii.html#cb99-1"></a><span class="co"># 9</span></span>
<span id="cb99-2"><a href="computing-bayes-factors-part-ii.html#cb99-2"></a></span>
<span id="cb99-3"><a href="computing-bayes-factors-part-ii.html#cb99-3"></a><span class="co"># Example 1</span></span>
<span id="cb99-4"><a href="computing-bayes-factors-part-ii.html#cb99-4"></a></span>
<span id="cb99-5"><a href="computing-bayes-factors-part-ii.html#cb99-5"></a><span class="co"># First get the unsurprising range of data values</span></span>
<span id="cb99-6"><a href="computing-bayes-factors-part-ii.html#cb99-6"></a></span>
<span id="cb99-7"><a href="computing-bayes-factors-part-ii.html#cb99-7"></a><span class="co"># work out the range of unsurprising values in t units</span></span>
<span id="cb99-8"><a href="computing-bayes-factors-part-ii.html#cb99-8"></a>t_range<span class="fl">.1</span> =<span class="st"> </span><span class="kw">qt</span>(.<span class="dv">975</span>, <span class="dt">df =</span> <span class="dv">50</span>, <span class="dt">ncp =</span> <span class="dv">0</span>)</span>
<span id="cb99-9"><a href="computing-bayes-factors-part-ii.html#cb99-9"></a></span>
<span id="cb99-10"><a href="computing-bayes-factors-part-ii.html#cb99-10"></a><span class="co"># unscale this so that it&#39;s in original units</span></span>
<span id="cb99-11"><a href="computing-bayes-factors-part-ii.html#cb99-11"></a>mean_range<span class="fl">.1</span> =<span class="st"> </span>t_range<span class="fl">.1</span> <span class="op">*</span><span class="st"> </span>se<span class="fl">.1</span></span>
<span id="cb99-12"><a href="computing-bayes-factors-part-ii.html#cb99-12"></a></span>
<span id="cb99-13"><a href="computing-bayes-factors-part-ii.html#cb99-13"></a><span class="kw">plot</span>(data_model<span class="fl">.1</span>, <span class="dt">theta =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">30</span>,<span class="dv">30</span>,.<span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="op">-</span>.<span class="dv">02</span>,.<span class="dv">4</span>)) <span class="op">+</span></span>
<span id="cb99-14"><a href="computing-bayes-factors-part-ii.html#cb99-14"></a><span class="kw">geom_errorbarh</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">xmin =</span> <span class="op">-</span>mean_range<span class="fl">.1</span>, <span class="dt">xmax =</span> mean_range<span class="fl">.1</span>, <span class="dt">y =</span> <span class="dv">0</span>), <span class="dt">height =</span> <span class="fl">.02</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb99-15"><a href="computing-bayes-factors-part-ii.html#cb99-15"></a><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> mean_diff, <span class="dt">linetype =</span> <span class="dv">2</span> ) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>(<span class="dv">12</span>) <span class="op">+</span></span>
<span id="cb99-16"><a href="computing-bayes-factors-part-ii.html#cb99-16"></a><span class="kw">labs</span>(<span class="dt">subtitle =</span> glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&quot;p = {round(p_value.1,2)}; BF01 = {round(BF01.1,2)}&quot;</span>), <span class="dt">x =</span> <span class="st">&quot;mean difference&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="computing-bayes-factors-part-ii.html#cb100-1"></a><span class="co"># 10</span></span>
<span id="cb100-2"><a href="computing-bayes-factors-part-ii.html#cb100-2"></a></span>
<span id="cb100-3"><a href="computing-bayes-factors-part-ii.html#cb100-3"></a><span class="co"># Example 2</span></span>
<span id="cb100-4"><a href="computing-bayes-factors-part-ii.html#cb100-4"></a></span>
<span id="cb100-5"><a href="computing-bayes-factors-part-ii.html#cb100-5"></a><span class="co"># First get the unsurprising range of data values</span></span>
<span id="cb100-6"><a href="computing-bayes-factors-part-ii.html#cb100-6"></a></span>
<span id="cb100-7"><a href="computing-bayes-factors-part-ii.html#cb100-7"></a><span class="co"># work out the range of unsurprising values in t units</span></span>
<span id="cb100-8"><a href="computing-bayes-factors-part-ii.html#cb100-8"></a>t_range<span class="fl">.2</span> =<span class="st"> </span><span class="kw">qt</span>(.<span class="dv">975</span>, <span class="dt">df =</span> <span class="dv">50</span>, <span class="dt">ncp =</span> <span class="dv">0</span>)</span>
<span id="cb100-9"><a href="computing-bayes-factors-part-ii.html#cb100-9"></a></span>
<span id="cb100-10"><a href="computing-bayes-factors-part-ii.html#cb100-10"></a><span class="co"># unscale this so that it&#39;s in original units</span></span>
<span id="cb100-11"><a href="computing-bayes-factors-part-ii.html#cb100-11"></a>mean_range<span class="fl">.2</span> =<span class="st"> </span>t_range<span class="fl">.2</span> <span class="op">*</span><span class="st"> </span>se<span class="fl">.2</span></span>
<span id="cb100-12"><a href="computing-bayes-factors-part-ii.html#cb100-12"></a></span>
<span id="cb100-13"><a href="computing-bayes-factors-part-ii.html#cb100-13"></a><span class="kw">plot</span>(data_model<span class="fl">.2</span>, <span class="dt">theta =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">30</span>,<span class="dv">30</span>,.<span class="dv">1</span>))  <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="op">-</span>.<span class="dv">02</span>,.<span class="dv">4</span>)) <span class="op">+</span></span>
<span id="cb100-14"><a href="computing-bayes-factors-part-ii.html#cb100-14"></a><span class="kw">geom_errorbarh</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">xmin =</span> <span class="op">-</span>mean_range<span class="fl">.2</span>, <span class="dt">xmax =</span> mean_range<span class="fl">.2</span>, <span class="dt">y =</span> <span class="dv">0</span>), <span class="dt">height =</span> <span class="fl">.02</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb100-15"><a href="computing-bayes-factors-part-ii.html#cb100-15"></a><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> mean_diff, <span class="dt">linetype =</span> <span class="dv">2</span> ) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>(<span class="dv">12</span>)  <span class="op">+</span></span>
<span id="cb100-16"><a href="computing-bayes-factors-part-ii.html#cb100-16"></a><span class="kw">labs</span>(<span class="dt">subtitle =</span> glue<span class="op">::</span><span class="kw">glue</span>(<span class="st">&quot;p = {round(p_value.2,2)}; BF01 = {round(BF01.2,2)}&quot;</span>), <span class="dt">x =</span> <span class="st">&quot;mean difference&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<p>In the plots we can see that in example 1, a very wide range of values of the mean difference could plausibly produce the value of the mean difference we actually observed. In example 2, however, the range of plausible values for the mean difference is very small. In example 1, the range of values includes values that are both very big and very small. That is, data show that we’re very uncertain about the actual value of the mean difference with the likelihood being wide and spread out; therefore, the BF value does allow us to make any strong conclusions either way about which model is best supported. In example 2, however, the range is narrow and all the values are very close to 0 (our null value)—that is, the likelihood is highly peaked near 0.</p>
<p>The frequentist inference asks something completely different. We set the parameter to 0, and then generate data based on this. We compare this generated data with our actual data and ask if it’s surprising or not. From the first plot, we see that the “unsurprising” range is very large. Our data lies somewhere near the middle of the range. In the second figure, the range is very narrow. As a result, our data now lies right near the edge of the range.</p>
<p>Again, because this is not a class on frequentist inference I won’t give details on what I think the <strong>correct</strong> frequentist analysis for these example should be. But these examples are illustrative because they employ the <strong>common</strong> way <strong>most people</strong> would analyse this kind data.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="computing-bayes-factors-part-i.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book.pdf", "book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
